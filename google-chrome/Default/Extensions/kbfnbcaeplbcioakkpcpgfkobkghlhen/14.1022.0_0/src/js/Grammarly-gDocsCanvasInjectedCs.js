/*! For license information please see Grammarly-gDocsCanvasInjectedCs.js.LICENSE.txt */
var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{m:()=>de});class r{constructor(e,t,r,n){this._customInboundEventName=t,this._customOutboundEventName=r,this._wrapOutboundMessage=n,this.inbound={subscribe:e=>{const t=({detail:t})=>{const r=t;e&&("function"==typeof e?e(r):e.next&&e.next(r))};return this._target.addEventListener(this._customInboundEventName,t,!1),{unsubscribe:()=>this._target.removeEventListener(this._customInboundEventName,t,!1)}}},this.outbound=e=>{const t=this._wrapOutboundMessage?this._wrapOutboundMessage(e):e,r=new CustomEvent(this._customOutboundEventName,{bubbles:!0,cancelable:!0,detail:t});this._target.dispatchEvent(r)},this._target=e.defaultView||e}}var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}Object.create;Object.create;function i(e){return"function"==typeof e}var s=!1,a={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;s=e},get useDeprecatedSynchronousErrorHandling(){return s}};function c(e){setTimeout((function(){throw e}),0)}var u={closed:!0,next:function(e){},error:function(e){if(a.useDeprecatedSynchronousErrorHandling)throw e;c(e)},complete:function(){}},l=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function p(e){return null!==e&&"object"==typeof e}var d=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),h=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this,n=r._parentOrParents,o=r._ctorUnsubscribe,s=r._unsubscribe,a=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var c=0;c<n.length;++c){n[c].remove(this)}if(i(s)){o&&(this._unsubscribe=void 0);try{s.call(this)}catch(e){t=e instanceof d?f(e.errors):[e]}}if(l(a)){c=-1;for(var u=a.length;++c<u;){var h=a[c];if(p(h))try{h.unsubscribe()}catch(e){t=t||[],e instanceof d?t=t.concat(f(e.errors)):t.push(e)}}}if(t)throw new d(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof e){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function f(e){return e.reduce((function(e,t){return e.concat(t instanceof d?t.errors:t)}),[])}var g=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),b=function(e){function t(r,n,o){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=u;break;case 1:if(!r){i.destination=u;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new y(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new y(i,r,n,o)}return i}return o(t,e),t.prototype[g]=function(){return this},t.create=function(e,r,n){var o=new t(e,r,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(h),y=function(e){function t(t,r,n,o){var s,a=e.call(this)||this;a._parentSubscriber=t;var c=a;return i(r)?s=r:r&&(s=r.next,n=r.error,o=r.complete,r!==u&&(i((c=Object.create(r)).unsubscribe)&&a.add(c.unsubscribe.bind(c)),c.unsubscribe=a.unsubscribe.bind(a))),a._context=c,a._next=s,a._error=n,a._complete=o,a}return o(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=a.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):c(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;c(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),a.useDeprecatedSynchronousErrorHandling)throw e;c(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(c(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(b);var m=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new _(e,this.project,this.thisArg))},e}(),_=function(e){function t(t,r,n){var o=e.call(this,t)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return o(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(b);Error;var v;!function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}(v||(v={})).create=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}();void 0!==self.requestIdleCallback&&self.requestIdleCallback;var w=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function E(e){return e}function x(e){return 0===e.length?E:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var S=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,o=function(e,t,r){if(e){if(e instanceof b)return e;if(e[g])return e[g]()}return e||t||r?new b(e,t,r):new b(u)}(e,t,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||a.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),a.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,r=t.closed,n=t.destination,o=t.isStopped;if(r||o)return!1;e=n&&n instanceof b?n:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=T(t))((function(t,n){var o;o=r.subscribe((function(t){try{e(t)}catch(e){n(e),o&&o.unsubscribe()}}),n,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[w]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:x(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=T(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function T(e){if(e||(e=a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}function C(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var N=C(),O=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function P(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var A=function(e){if(e&&"function"==typeof e[w])return o=e,function(e){var t=o[w]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(O(e))return n=e,function(e){for(var t=0,r=n.length;t<r&&!e.closed;t++)e.next(n[t]);e.complete()};if(P(e))return r=e,function(e){return r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,c),e};if(e&&"function"==typeof e[N])return t=e,function(e){for(var r=t[N]();;){var n=void 0;try{n=r.next()}catch(t){return e.error(t),e}if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add((function(){r.return&&r.return()})),e};var t,r,n,o,i=p(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function I(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[w]}(e))return function(e,t){return new S((function(r){var n=new h;return n.add(t.schedule((function(){var o=e[w]();n.add(o.subscribe({next:function(e){n.add(t.schedule((function(){return r.next(e)})))},error:function(e){n.add(t.schedule((function(){return r.error(e)})))},complete:function(){n.add(t.schedule((function(){return r.complete()})))}}))}))),n}))}(e,t);if(P(e))return function(e,t){return new S((function(r){var n=new h;return n.add(t.schedule((function(){return e.then((function(e){n.add(t.schedule((function(){r.next(e),n.add(t.schedule((function(){return r.complete()})))})))}),(function(e){n.add(t.schedule((function(){return r.error(e)})))}))}))),n}))}(e,t);if(O(e))return function(e,t){return new S((function(r){var n=new h,o=0;return n.add(t.schedule((function(){o!==e.length?(r.next(e[o++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}(e,t);if(function(e){return e&&"function"==typeof e[N]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new S((function(r){var n,o=new h;return o.add((function(){n&&"function"==typeof n.return&&n.return()})),o.add(t.schedule((function(){n=e[N](),o.add(t.schedule((function(){if(!r.closed){var e,t;try{var o=n.next();e=o.value,t=o.done}catch(e){return void r.error(e)}t?r.complete():(r.next(e),this.schedule())}})))}))),o}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}var k,M=new S((function(e){return e.complete()}));function D(e,t){return new S((function(r){var n,o;try{n=e()}catch(e){return void r.error(e)}try{o=t(n)}catch(e){return void r.error(e)}var i,s,a=(o?(i=o,s?I(i,s):i instanceof S?i:new S(A(i))):M).subscribe(r);return function(){a.unsubscribe(),n&&n.unsubscribe()}}))}!function(e){e.measure=e=>t=>new S((r=>t.subscribe((t=>e((()=>r.next(t)))),(e=>r.error(e)),(()=>r.complete())))),e.using=(e,t)=>D(e,t),e.doNothing=e=>e}(k||(k={}));function R(e,t,r){return{call(n,o,i,s){var a;const c=s(i),u=null===(a=t.postFn)||void 0===a?void 0:a[o];if(u)try{u(n,e,i,c)}catch(e){r.logException(`proxy.call.${String(o)}`,e)}return c},set(n,o,i,s){var a;const c=null===(a=t.overrideSet)||void 0===a?void 0:a[o];if(c)try{const t=c(n,e,i);if(void 0!==t)return s(t)}catch(e){r.logException(`proxy.set.${String(o)}`,e)}return s(i)}}}function j(e){const t=/^(?:([\d\w]+) )?(?:(\w+) )?([\d\.]+)px (?:[\'\"])?([\w \-]+)(?:[\'\"])?$/.exec(e);if(t){const[e,r,n,o,i]=t;let s="400",a="normal";return r&&(isNaN(parseInt(r,10))?"italic"===r?(a="italic",s=isNaN(parseInt(n,10))?"bold"===n?"700":"400":n):s="bold"===r?"700":"400":(s=r,a=n||a)),`${s} ${a} ${parseFloat(o).toFixed(4)}px "${i}"`}return e}var F;function $(e,t,r){const n=new DOMPoint(e,t).matrixTransform(r);return{x:n.x,y:n.y}}function B(e,t,r,n,o=!1){const i=(e,t,r,n=!1)=>{e.beginPath(),e.strokeStyle=`rgba(0,0,255,${n?.05:.2})`,e.lineWidth=2,e.moveTo(t,r),e.lineTo(t,r-20),e.stroke()};e.save(),e.resetTransform(),i(e,t,r,o),n.forEach((n=>i(e,t+n,r,o))),e.restore()}!function(e){e.text="text",e.space="space",e.lineBreak="lineBreak"}(F||(F={}));const U=(e,t,r,n,o,i=0,s=0,a=!1)=>{e.save(),e.resetTransform(),e.fillStyle=`rgba(221,0,0,${a?.05:.1})`,e.fillRect(t,r,n,10),e.fillStyle=`rgba(221,0,0,${a?.4:.8})`,e.font="10px Arial",e.fillText(`${i}`,t,r+10),e.fillStyle=`rgba(0,128,221,${a?.4:.8})`,e.fillText(`${s}`,t,r+20),B(e,t,r,o,a),e.restore()},z=(e,t,r,n,o,i=!1)=>{e.save(),e.resetTransform(),e.fillStyle=`rgba(0,221,0,${i?.05:.1})`,e.fillRect(t,r+10,n,10),e.restore(),B(e,t,r,o,i)},H=(e,t,r,n=!1)=>{e.save(),e.resetTransform(),e.beginPath(),e.strokeStyle=`rgba(0,221,0,${n?.05:.1})`,e.lineWidth=5,e.moveTo(t+2.5,r),e.lineTo(t+2.5,r+10),e.lineTo(t-10,r+10),e.stroke(),e.restore()},q=(e,t,r,n)=>{e.save(),e.resetTransform(),e.font="12px Arial",e.fillStyle="rgba(0,128,221,0.8)",e.fillText(`${n}`,t,r),e.restore()};function L(e){return(t,r)=>{const n=function(e,t,r){const n=r.slice(0);return n[0]===e?(n.shift(),0===n.length?{shouldStart:!0,newPageCandidate:t.slice(0)}:{shouldStart:!1,newPageCandidate:n}):n.length<t.length?{shouldStart:!1,newPageCandidate:t.slice(0)}:{shouldStart:!1,newPageCandidate:n}}(e,r.newPageRoutine,r.newPageCandidate);n.shouldStart?function(e,t){t.wordCounter={main:0,footer:0,header:0};const r=(n=t.getCurrentPage(),{fragments:{main:{fragments:[],length:0},header:{fragments:[],length:0},footer:{fragments:[],length:0}},page:null!=n?n:-1});var n;t.currentPageMap=r,t.currentSelection=[],t.pageCleared=!0,t.newPageRoutine=W.slice(0),t.newPageCandidate=W.slice(0),t.clipCandidate={clip:null,clipCandidate:Y.slice(0)},t.savedClipStates=[],t.currentClips=[],t.matchingBroken=!1,t.pagesMap.set(r.page,r);const o=Array.from(t.pagesMap.values()).reduce(((e,t)=>e+(t.page<r.page?t.fragments.main.length:0)),0);if(t.debugVizualize){const t=$(20,20,e.getTransform());q(e,t.x,t.y,`Text starts at: ${o}`)}}(t,r):r.newPageCandidate=n.newPageCandidate}}function V(e){return(t,r,n)=>{const o=function(e,t,r,n,o){var i,s,a,c;const u=n.slice(0);return u[0]===e?(u.shift(),0===u.length?{clip:t,clipCandidate:u.slice(0),clipWasSet:!0}:{clip:"rect"===e&&o?{x:null!==(i=o[0])&&void 0!==i?i:0,y:null!==(s=o[1])&&void 0!==s?s:0,width:null!==(a=o[2])&&void 0!==a?a:0,height:null!==(c=o[3])&&void 0!==c?c:0}:t,clipCandidate:u.slice(0),clipWasSet:!1}):u.length<r.length?{clip:null,clipCandidate:r.slice(0),clipWasSet:!1}:{clip:t,clipCandidate:u,clipWasSet:!1}}(e,r.clipCandidate.clip,r.clipRoutine,r.clipCandidate.clipCandidate,n);o.clipWasSet&&o.clip?(r.currentPageClip||(r.currentPageClip=o.clip),r.currentClips.push(o.clip)):r.clipCandidate={clip:o.clip,clipCandidate:o.clipCandidate}}}const W=["clearRect","save","scale"],Y=["beginPath","rect","clip"];function G(e,t,r,n,o,i){var s,a;if(!function(e,t){return!!e.currentPageMap||(e.api.log(t,"Current page map expected"),!1)}(o,"proxy.processFillText"))return;const{api:c,currentPageMap:u,metricsMap:l}=o,p=i.getTransform(),d=$(t,r,p),h=e.substr(1,e.length-2)||"",f="footer"===n?u.fragments.footer:"header"===n?u.fragments.header:u.fragments.main,g=j(null!==(s=o.font)&&void 0!==s?s:i.font),b=f.fragments[f.fragments.length-1];if(b&&b.type===F.text){const e=b.position,t=d.x-e.x-b.width;e.y===d.y&&t>1&&(f.fragments.push({type:F.space,position:{x:e.x+b.width,y:d.y},width:t,height:b.height}),f.length++,o.debugVizualize&&z(i,e.x+b.width,d.y,t,[],"main"!==n)),d.y>e.y&&(f.fragments.push({type:F.lineBreak,position:{x:e.x+b.width,y:e.y},height:b.height}),f.length++,o.debugVizualize&&H(i,e.x+b.width,e.y,"main"!==n))}(null!==(a=h.match(/[^\s]+|\s+/g))&&void 0!==a?a:[]).forEach((e=>{var t;const r=null===(t=l.get(g))||void 0===t?void 0:t.get(e);if(r){const{width:t,height:s}=function(e,t,r){return{width:r.a*e+r.c*t,height:r.b*e+r.d*t}}(r.chunk.width,r.chunk.actualBoundingBoxAscent+r.chunk.actualBoundingBoxDescent,p),a={type:F.text,text:e,position:{...d},width:t,height:s,charShifts:r.charShifts.map((e=>function(e,t){return t.a*e}(e.width,p)))};f.fragments.push(a),o.debugVizualize&&(e.match(/^\s+$/)?z(i,d.x,d.y,t,a.charShifts,"main"!==n):U(i,d.x,d.y,a.width,a.charShifts," "===e?void 0:o.wordCounter[n]++," "===e?void 0:f.length,"main"!==n)),f.length+=e.length,d.x+=t}else o.matchingBroken||(o.matchingBroken=!0,c.log("proxy.fillText","matching is broken",{chunk:e,fontStyle:g,targetFont:o.font}))}))}const Q=L("clearRect"),K=L("save"),X=V("wrong"),J={postFn:{fillText(e,t,[r,n,o,i]){X(e,t),!function(e){const{currentClips:t,currentPageClip:r}=e;if(t.length&&r){const e=t[t.length-1],n=r;return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height!==n.height}return!1}(t)?!function(e){const{currentClips:t,currentPageClip:r}=e;if(t.length&&r){const e=t[t.length-1],n=r;return e.x===n.x&&e.y!==n.y&&e.width===n.width&&e.y-n.y+e.height===n.height}return!1}(t)?G(r,n,o,"main",t,e):G(r,n,o,"footer",t,e):G(r,n,o,"header",t,e)},fillRect(e,t,[r,n,o,i]){X(e,t),"rgba(118, 167, 250, 0.501960784313726)"===e.fillStyle&&t.currentSelection.push({x:r,y:n,width:o,height:i})},clearRect(e,t){X(e,t),Q(e,t)},save(e,t){t.saveCount++,X(e,t),K(e,t),function(e){e.currentClips.length&&e.savedClipStates.push(e.currentClips.slice())}(t)},scale:L("scale"),restore(e,t){!function(e){e.savedClipStates.length?e.currentClips=e.savedClipStates.pop():e.currentClips=[]}(t),t.saveCount--,0===t.saveCount&&t.currentPageMap&&t.api.pageRendered({pageMap:{page:t.currentPageMap.page,fragments:t.currentPageMap.fragments},selection:t.currentSelection})},beginPath:V("beginPath"),clip:V("clip"),rect:V("rect")},overrideSet:{strokeStyle:(e,t,r)=>"rgba(221,0,0,1)"===r||"rgba(66,133,244,1)"===r?"rgba(0,0,0,0)":void 0,fillStyle:(e,t,r)=>"rgba(252,232,230,1)"===r||"rgba(232,240,254,1)"===r?"rgba(0,0,0,0)":void 0,font(e,t,r){t.font=r}}};class Z extends Error{constructor(e){super(`Assertion failed: ${e?"string"==typeof e?e:e():"(unnamed)"}`)}}function ee(e,t){if(null==e)throw new Z((()=>t?`Expected ${t} to be non-null`:"Expected non-null"));return e}const te=new Set(["version","title","lang","translate","dir","dataset","hidden","tabIndex","accessKey","draggable","spellcheck","contentEditable","isContentEditable","offsetParent","offsetTop","offsetLeft","offsetWidth","offsetHeight","style","innerText","outerText","onabort","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","onvolumechange","onwaiting","onwheel","ongotpointercapture","onlostpointercapture","onpointerdown","onpointermove","onpointerup","onpointercancel","onpointerover","onpointerout","onpointerenter","onpointerleave","click","focus","blur","onauxclick","nonce","namespaceURI","prefix","localName","tagName","id","className","classList","slot","attributes","shadowRoot","assignedSlot","innerHTML","outerHTML","scrollTop","scrollLeft","scrollWidth","scrollHeight","clientTop","clientLeft","clientWidth","clientHeight","onbeforecopy","onbeforecut","onbeforepaste","oncopy","oncut","onpaste","onsearch","onselectstart","previousElementSibling","nextElementSibling","children","firstElementChild","lastElementChild","childElementCount","onwebkitfullscreenchange","onwebkitfullscreenerror","setPointerCapture","releasePointerCapture","hasPointerCapture","hasAttributes","getAttributeNames","getAttribute","getAttributeNS","setAttribute","setAttributeNS","removeAttribute","removeAttributeNS","hasAttribute","hasAttributeNS","getAttributeNode","getAttributeNodeNS","setAttributeNode","setAttributeNodeNS","removeAttributeNode","closest","matches","webkitMatchesSelector","attachShadow","getElementsByTagName","getElementsByTagNameNS","getElementsByClassName","insertAdjacentElement","insertAdjacentText","insertAdjacentHTML","requestPointerLock","getClientRects","getBoundingClientRect","scrollIntoView","scrollIntoViewIfNeeded","createShadowRoot","getDestinationInsertionPoints","animate","remove","querySelector","querySelectorAll","webkitRequestFullScreen","webkitRequestFullscreen","scroll","scrollTo","scrollBy","before","after","replaceWith","prepend","append","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","nodeType","nodeName","baseURI","isConnected","ownerDocument","parentNode","parentElement","childNodes","firstChild","lastChild","previousSibling","nextSibling","nodeValue","textContent","hasChildNodes","getRootNode","normalize","cloneNode","isEqualNode","isSameNode","compareDocumentPosition","contains","lookupPrefix","lookupNamespaceURI","isDefaultNamespace","insertBefore","appendChild","replaceChild","removeChild","addEventListener","removeEventListener","dispatchEvent"]),re=["autocorrect","comment","composing_decoration","composing_region","draft_comment","ignore_spellcheck","ignore_word","import_warnings","link","named_range","revision_diff","smart_todo","spellcheck","suppress_feature","text","voice_corrections","voice_dotted_span","autogen","cell","citation_sources","column_sector","date_time","document","equation","equation_function","footnote","headings","horizontal_rule","language","list","paragraph","row","tbl"],ne=[61439,61438,59651,26,30,59649,3,59653,59652,16,17],oe=[47,91,61439,61438,59651,26,30,59649,3,59653,59652,16,17,93,47,103].reduce(((e,t)=>e+String.fromCharCode(t)),""),ie=[47,91,28,3,59653,59651,26,25,31,92,110,18,16,93,47,103].reduce(((e,t)=>e+String.fromCharCode(t)),"");function se(e,t,r,n=Object.getOwnPropertyNames(e)){const o=new Set,i=[];let s=0;const a=(n,c,u,l=0)=>{if(s++,"prototype"===n||c instanceof Window)return;if(l>r)return;const p=[...u,n];try{if(t(n,c))return void i.push({path:p,value:c})}catch(e){}var d;if(null!=c&&!o.has(c))if(o.add(c),Array.isArray(c))c.forEach(((e,t)=>{try{a(t.toString(),e,p,l+1)}catch(e){}}));else if(c instanceof Object){((d=c)&&null!==d&&1===d.nodeType&&"string"==typeof d.nodeName?Object.getOwnPropertyNames(e).filter((e=>!te.has(e))):Object.getOwnPropertyNames(c)).forEach((e=>{try{a(e,c[e],p,l+1)}catch(e){}}))}};return n.forEach((t=>{try{a(t,e[t],[])}catch(e){}})),{results:i,iterations:s}}function ae(e){const t=ee(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),r=ee(e[t],"kixApp"),n=function(e,t){const r=new Set;return e.filter((e=>{const n=t(e);return!r.has(n)&&(r.add(n),!0)}))}(se(r,((e,t)=>t&&""===t.toString().charAt(0)),5).results,(e=>e.value)).filter((e=>isNaN(parseInt(e.path[e.path.length-1],10)))).reduce(((e,n)=>{const o=n.path.slice(0,n.path.length-1).reduce(((e,t)=>e[t]),r),i=se(o,((e,t)=>t instanceof RegExp),1);let s=!1,a=!1;if(1===i.results.length){const e=i.results[0].value;s=e.toString()===ie,a=e.toString()===oe}else{1===se(o,((e,t)=>Array.isArray(t)&&t.length===ne.length&&t.every(((e,t)=>e.charCodeAt(0)===ne[t]))),1).results.length&&(a=!0)}return s?{...e,headersAndFooters:[t].concat(n.path)}:a?{...e,text:[t].concat(n.path)}:e}),{text:[],headersAndFooters:[]});return 0===n.text.length?null:n}class ce{constructor(e){this._win=e,this._result=null}_attemptTextExtraction(){try{const e=ae(this._win),t=Boolean(null==e?void 0:e.headersAndFooters.length),r=(null==e?void 0:e.text)||[],n=r.pop(),o=r.reduce(((e,t)=>e[t]),this._win),i=(null==e?void 0:e.headersAndFooters)||[],s=i.pop(),a=i.reduce(((e,t)=>e[t]),this._win);if(r.length>0){const{suggestionsFullArrayPath:e,suggestionFastArrayPath:i}=function(e,t){try{const r=ee(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),n=se(ee(e[r],"kixApp"),((e,t)=>t&&Array.isArray(t)&&t.some((e=>Array.isArray(e)&&-1!==e.toString().indexOf("suggest.")))),10).results.filter((e=>e.path[0]===t[1])).filter((e=>!re.some((t=>e.path.includes(t))))).map((e=>{const t=[...e.path];return t.pop(),t})).reduce(((t,n)=>{const o=[r].concat(n).reduce(((e,t)=>e[t]),e);return t?o[t.idProp]>t.id?{...t,id:o[t.idProp],path:n}:t:Object.getOwnPropertyNames(o).reduce(((e,t)=>Array.isArray(o[t])||isNaN(parseInt(o[t],10))?Array.isArray(o[t][0])?{...e,fullArrayProp:t}:{...e,compactArrayProp:t}:{...e,idProp:t,id:o[t]}),{path:n})}),null);return{suggestionFastArrayPath:n?[r].concat(n.path,n.compactArrayProp):null,suggestionsFullArrayPath:n?[r].concat(n.path,n.fullArrayProp):null}}catch(e){return{suggestionFastArrayPath:null,suggestionsFullArrayPath:null}}}(this._win,r),c=Array.isArray(e)&&e.pop(),u=Array.isArray(i)&&i.pop(),l=e&&e.reduce(((e,t)=>e[t]),this._win);return{getText:()=>{const e=o[n],r=t?a[s]:"",i=l&&c&&l[c],p=l&&u&&l[u];if("string"==typeof e){if(i&&p){let t=!1,n=0;return{checkableText:p.concat([e.length-1]).reduce(((r,o)=>{let s=r;return t||(s+=e.slice(n,o)),t=!(!i[o]||!i[o][0]),n=o,s}),""),fullText:e,headersAndFootersText:r,ignoredRanges:[...i].reduce(((e,t)=>(e.push(Array.isArray(t)?!!t[0]:!!e.length&&e[e.length-1]),e)),[])}}return{checkableText:e,fullText:e,headersAndFootersText:r,ignoredRanges:[]}}throw new Error("unexpected text value type")},gotIgnoredRanges:!!l}}return{error:"notFound"}}catch(e){return{error:"exception",message:e.message}}}_getText(e){try{return this._result||(this._result=this._attemptTextExtraction()),e.reQueryForIgnoredRanges&&"getText"in this._result&&!this._result.gotIgnoredRanges&&(this._result=this._attemptTextExtraction()),"getText"in this._result?this._result.getText():null}catch(e){return null}}getText(e){return this._getText(e)}}var ue;!function(e){function t(e){return new Promise(e)}e.create=t,e.createCompletionSource=function(){let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve(t){e(t)},reject(e){t(e)}}},e.sync=function(e){return t(((t,r)=>t(e())))},e.delay=function(t){return e.create((e=>{setTimeout((()=>{e()}),t)}))}}(ue||(ue={}));Error;class le{constructor(e,t){this._transport=e,this._log=t,this._calls=new Map,this._sub=this._transport.inbound.subscribe((e=>{var t;const r=this._calls.get(e.id);if(r)try{"err"in e?r.reject(e.err):r.resolve(e.res)}finally{this._calls.delete(e.id)}else null===(t=this._log)||void 0===t||t.warn(`received rpc call response for unregistered call ${e.id}`)})),this.api=new Proxy({},{get:(e,t)=>"then"===t?void 0:(...e)=>this._handleCall(t,e)})}_handleCall(e,t){let r=v.create();for(;this._calls.has(r);)r=v.create();const n=ue.createCompletionSource();return this._calls.set(r,n),this._transport.outbound({id:r,method:e,args:t}),n.promise}dispose(){this._sub.unsubscribe()}}class pe{constructor(e,t){this._transport=e,this._api=t,this._disposed=!1,this._sub=this._transport.inbound.subscribe((async e=>{try{const t=this._api[e.data.method];if("function"!=typeof t)throw{message:`invalid method name ${e.data.method}`};{const r={clientId:e.clientId},n=await t.call(this._api,r,...e.data.args);this._transport.outbound({clientId:e.clientId,data:{id:e.data.id,res:n}})}}catch(t){this._transport.outbound({clientId:e.clientId,data:{id:e.data.id,err:t}})}}))}dispose(){this._disposed||(this._disposed=!0,this._sub.unsubscribe())}}const de=e=>(t,n)=>{const{request:o,response:i}=function(e){return{request:`cs-grm-request-${e}`,response:`cs-grm-response-${e}`}}(e),s=new le(new r(document,i,o)),a=new Map;!async function(){try{const o=document.querySelector(".kix-rotatingtilemanager");if(!o)throw new Error("Cannot find rotating tile manager");const i=function(){const e=[];function t(t,r){e[t]=r}return{identifyPage(r){let n=0,o=-1;for(;n<=r.top;){if(n+18>r.top)return t(o+1,r),o+1;if(o++,o>=e.length)break;e[o]&&(n=e[o].top+e[o].height)}}}}();t((e=>{if(function(e){return Boolean(e.className)}(e)){const t=function({api:e,metricsMap:t,pagesMap:r,getCurrentPage:n,debugVizualize:o}){return{api:e,debugVizualize:o,getCurrentPage:n,pageCleared:!1,matchingBroken:!1,currentSelection:[],pagesMap:r||new Map,currentPageClip:null,metricsMap:t||new Map,wordCounter:{main:0,footer:0,header:0},newPageRoutine:W.slice(0),newPageCandidate:W.slice(0),clipRoutine:Y.slice(0),clipCandidate:{clip:null,clipCandidate:Y.slice(0)},saveCount:0,savedClipStates:[],currentClips:[]}}({api:s.api,metricsMap:n.metricsMap,pagesMap:a,debugVizualize:!0,getCurrentPage(){const t=o.getBoundingClientRect(),{left:r,top:n,width:a,height:c}=e.getBoundingClientRect(),u={left:r-t.left,top:n-t.top,width:a,height:c},l=i.identifyPage(u);return void 0===l&&s.api.logError("pageManager.identifyPage","Cannot identify page number",{rect:u}),l}});return function({api:e,state:t}){return R(t,J,e)}({api:s.api,state:t})}}));const c=new ce(self),{request:u,response:l}=function(e){return{request:`is-grm-request-${e}`,response:`is-grm-response-${e}`}}(e),p=new pe(function(e,t=v.create()){return{inbound:(o=e.inbound,o instanceof S?o:new S((e=>o.subscribe(e)))).pipe((r=e=>({data:e,clientId:t}),function(e){if("function"!=typeof r)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return e.lift(new m(r,n))})),outbound(r){r.clientId===t&&e.outbound(r.data)}};var r,n,o}(new r(document,u,l)),{getText:(e,t)=>c.getText(t||{reQueryForIgnoredRanges:!1}),dispose:e=>{p.dispose()}});await s.api.init()&&console.log("Grammarly communication channel has been successfully established.")}catch(e){try{await s.api.logException("init",e)}catch(e){}}}()};var he=t.m;export{he as startCanvasInjectedApp};